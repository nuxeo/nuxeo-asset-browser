<?xml version="1.0" encoding="UTF-8"?>
<component name="org.nuxeo.dam.layouts">

  <extension target="org.nuxeo.ecm.platform.forms.layout.WebLayoutManager"
    point="widgettypes">
    <widgetType name="dam_title">
      <configuration>
        <sinceVersion>5.7</sinceVersion>
        <title>Title</title>
        <description>
          <p>
            This widget type displays the title of a document.
          </p>
          <p>
            It requires the following fields configuration:
            <ul>
              <li>
                first field maps the document model, it will be used to
                display the title
              </li>
              <li>
                second field maps the label used as the tooltip of the
                document title
              </li>
            </ul>
          </p>
        </description>
      </configuration>
      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /dam/widgets/title_widget_template.xhtml
      </property>
    </widgetType>

    <widgetType name="damAssetViewNoDocument">
      <configuration>
        <sinceVersion>5.7</sinceVersion>
        <title>No Document selected</title>
        <description>
          <p>
            This widget type displays a placeholder when no document is selected.
          </p>
        </description>
      </configuration>
      <handler-class>
        org.nuxeo.ecm.platform.forms.layout.facelets.plugins.TemplateWidgetTypeHandler
      </handler-class>
      <property name="template">
        /dam/widgets/dam_asset_view_no_document.xhtml
      </property>
    </widgetType>
  </extension>

  <extension target="org.nuxeo.ecm.platform.forms.layout.WebLayoutManager"
    point="widgets">

    <widget name="damPanelLeft" type="currentDocumentActionsWithForms">
      <properties widgetMode="view">
        <property name="category">DAM_PANEL_LEFT</property>
      </properties>
    </widget>

    <widget name="damPanelCenter" type="currentDocumentActions">
      <properties widgetMode="view">
        <property name="category">DAM_PANEL_CENTER</property>
      </properties>
      <controls mode="any">
        <control name="requireSurroundingForm">false</control>
      </controls>
    </widget>

    <widget name="damPanelRight" type="currentDocumentActions">
      <properties widgetMode="view">
        <property name="category">DAM_PANEL_RIGHT</property>
      </properties>
      <controls mode="any">
        <control name="requireSurroundingForm">false</control>
      </controls>
    </widget>

    <widget name="damSearchesSelector" type="template">
      <properties widgetMode="any">
        <property name="template">/dam/widgets/dam_searches_selector_widget_template.xhtml</property>
      </properties>
    </widget>

    <widget name="damSearchFilters" type="template">
      <properties widgetMode="any">
        <property name="template">/dam/widgets/dam_search_filters_widget_template.xhtml</property>
      </properties>
    </widget>

    <widget name="damSearchActions" type="template">
      <properties widgetMode="any">
        <property name="template">/dam/widgets/dam_search_actions_widget_template.xhtml</property>
      </properties>
    </widget>

    <widget name="damSearchResults" type="template">
      <properties widgetMode="any">
        <property name="template">/dam/widgets/dam_search_results_widget_template.xhtml</property>
      </properties>
    </widget>

    <widget name="damAssetViewNoDocument" type="damAssetViewNoDocument">
      <labels>
        <label mode="any"></label>
      </labels>
      <translated>false</translated>
    </widget>

    <widget name="damAssetViewTitle" type="dam_title">
      <labels>
        <label mode="any"></label>
      </labels>
      <translated>false</translated>
      <fields>
        <field></field>
        <field>dc:description</field>
      </fields>
    </widget>

    <widget name="damAssetViewDamCommon" type="toggleableLayoutWithForms">
      <labels>
        <label mode="any">label.dam.common</label>
      </labels>
      <translated>true</translated>
      <handlingLabels>true</handlingLabels>
      <properties widgetMode="any">
        <property name="foldable">true</property>
        <property name="initialLayoutName">dam_common</property>
        <property name="useAjaxForm">true</property>
      </properties>
    </widget>

    <widget name="damAssetViewDublincore" type="toggleableLayoutWithForms">
      <labels>
        <label mode="any">label.schema.dublincore</label>
      </labels>
      <translated>true</translated>
      <handlingLabels>true</handlingLabels>
      <properties widgetMode="any">
        <property name="foldable">true</property>
        <property name="foldedByDefault">true</property>
        <property name="initialLayoutName">dublincore</property>
        <property name="useAjaxForm">true</property>
      </properties>
    </widget>

    <widget name="damc_author" type="text">
      <labels>
        <label mode="any">label.dam.damc.author</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>damc:author</field>
      </fields>
      <properties widgetMode="edit">
        <property name="styleClass">dataInputText</property>
      </properties>
    </widget>

    <widget name="damc_authoringDate" type="datetime">
      <labels>
        <label mode="any">label.dam.damc.authoringDate</label>
      </labels>
      <translated>true</translated>
      <fields>
        <field>damc:authoringDate</field>
      </fields>
      <properties widgetMode="view">
        <property name="pattern">#{nxu:basicDateFormater()}</property>
      </properties>
      <properties widgetMode="edit">
        <property name="format">#{nxu:basicDateFormater()}</property>
        <property name="styleClass">dataInputTextDate</property>
      </properties>
    </widget>

  </extension>

  <extension target="org.nuxeo.ecm.platform.actions.ActionService"
    point="actions">

    <action id="damSearchesSelector" type="widget" order="100">
      <category>DAM_PANEL_LEFT</category>
      <properties>
        <property name="widgetName">damSearchesSelector</property>
      </properties>
    </action>

    <action id="damSearchActionsTop" type="widget" order="200">
      <category>DAM_PANEL_LEFT</category>
      <properties>
        <property name="widgetName">damSearchActions</property>
      </properties>
    </action>

    <action id="damSearchFilters" type="widget" order="300">
      <category>DAM_PANEL_LEFT</category>
      <properties>
        <property name="widgetName">damSearchFilters</property>
      </properties>
    </action>

    <action id="damSearchActionsBottom" type="widget" order="400">
      <category>DAM_PANEL_LEFT</category>
      <properties>
        <property name="widgetName">damSearchActions</property>
      </properties>
    </action>

    <action id="damSearchResults" type="widget" order="100">
      <category>DAM_PANEL_CENTER</category>
      <properties>
        <property name="widgetName">damSearchResults</property>
      </properties>
    </action>

    <action id="damAssetViewNoDocument" type="widget" order="100">
      <category>DAM_PANEL_RIGHT</category>
      <properties>
        <property name="widgetName">damAssetViewNoDocument</property>
      </properties>
      <filter-id>noCurrentDocument</filter-id>
    </action>

    <action id="damAssetViewTitle" type="widget" order="100">
      <category>DAM_PANEL_RIGHT</category>
      <properties>
        <property name="widgetName">damAssetViewTitle</property>
      </properties>
      <filter-id>hasAssetFacet</filter-id>
    </action>

    <action id="damAssetViewPicture" type="widget" order="200">
      <category>DAM_PANEL_RIGHT</category>
      <properties>
        <property name="widgetName">summary_picture_view</property>
      </properties>
      <filter-id>hasPictureFacet</filter-id>
      <filter-id>hasAssetFacet</filter-id>
    </action>

    <action id="damAssetViewVideo" type="widget" order="200">
      <category>DAM_PANEL_RIGHT</category>
      <properties>
        <property name="widgetName">summary_video_player</property>
      </properties>
      <filter-id>hasVideoFacet</filter-id>
      <filter-id>hasAssetFacet</filter-id>
    </action>

    <action id="damAssetViewDamCommon" type="widget" order="300">
      <category>DAM_PANEL_RIGHT</category>
      <properties>
        <property name="widgetName">damAssetViewDamCommon</property>
      </properties>
      <filter-id>hasAssetFacet</filter-id>
    </action>

    <action id="damAssetViewDublincore" type="widget" order="400">
      <category>DAM_PANEL_RIGHT</category>
      <properties>
        <property name="widgetName">damAssetViewDublincore</property>
      </properties>
      <filter-id>hasAssetFacet</filter-id>
    </action>

  </extension>

  <extension target="org.nuxeo.ecm.platform.actions.ActionService"
    point="filters">

    <filter id="hasAssetFacet">
      <rule grant="true">
        <facet>Asset</facet>
      </rule>
    </filter>

    <filter id="hasVideoFacet">
      <rule grant="true">
        <facet>Video</facet>
      </rule>
    </filter>

    <filter id="noCurrentDocument">
      <rule grant="true">
        <condition>currentDocument == null</condition>
      </rule>
    </filter>

  </extension>

  <extension target="org.nuxeo.ecm.platform.forms.layout.WebLayoutManager"
    point="layouts">

    <layout name="gridDamLayout">
      <templates>
        <template mode="any">
          /layouts/layout_grid_template.xhtml
        </template>
      </templates>
      <rows>
        <row>
          <properties mode="any">
            <property name="nxl_gridStyleClass_0">gridStyle2</property>
            <property name="nxl_gridStyleClass_1">gridStyle6</property>
            <property name="nxl_gridStyleClass_2">gridStyle4</property>
          </properties>
          <widget>damPanelLeft</widget>
          <widget>damPanelCenter</widget>
          <widget>damPanelRight</widget>
        </row>
      </rows>
    </layout>

    <layout name="dam_common">
      <templates>
        <template mode="any">/layouts/layout_default_template.xhtml</template>
      </templates>
      <rows>
        <row>
          <widget>damc_author</widget>
        </row>
        <row>
          <widget>damc_authoringDate</widget>
        </row>
      </rows>
    </layout>

  </extension>

</component>
